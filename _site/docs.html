
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="javascripts/jquery.toc.js"></script>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <link rel="stylesheet" type="text/css" href="stylesheets/toc.css" media="print">

    <title>Fighter - Document</title>
</head>
<body>
    <header>
      <div class="container">
        <h1>Fighter</h1>
        <h2>An extensible micro-framework for HackLang</h2>

        <section id="downloads">
            <a href="/" class="btn">Home</a>
            <a href="install.html" class="btn">Install</a>
            <a href="docs.html" class="btn">Docs</a>
            <a href="https://github.com/slashmili/fighter" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>
    <div class="container">
        <h1> Docs</h1>
        <div id="main_content">
            <h1 id="base">Base</h1>
<p>The base appliaction should be like this :</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="k">require</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/vendor/autoload.php&#39;</span><span class="p">;</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Fighter\Application</span><span class="p">();</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span></code></pre></div>

<h1 id="routing">Routing</h1>
<p>Routing in Fighter is done by matching a URL pattern with a callback function.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="s1">&#39;Hello World!&#39;</span><span class="p">);</span></code></pre></div>

<p>The callback can be any object that is callable. So you can use a regular function:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="k">function</span> <span class="nf">hello</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Hello World!&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="s1">&#39;hello&#39;</span><span class="p">);</span></code></pre></div>

<p>Or a class method:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="k">class</span> <span class="nc">Greeting</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">hello</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;hello world!&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="p">[</span><span class="s1">&#39;Greeting&#39;</span><span class="p">,</span><span class="s1">&#39;hello&#39;</span><span class="p">]);</span></code></pre></div>

<h2 id="method-routing">Method Routing</h2>

<p>By default, route patterns are matched against all request methods. You can respond to specific methods by placing an identifier before the URL.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;GET /&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="s1">&#39;I received a GET request.&#39;</span><span class="p">);</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;POST /&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="s1">&#39;I received a POST request.&#39;</span><span class="p">);</span></code></pre></div>

<h2 id="regular-expressions">Regular Expressions</h2>
<p>You can use regular expressions in your routes:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/user/[0-9]+&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="s1">&#39;This will match /user/1234&#39;</span><span class="p">);</span></code></pre></div>

<h2 id="named-parameters">Named Parameters</h2>
<p>You can specify named parameters in your routes which will be passed along to your callback function.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/@name/@id&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$id</span><span class="p">)</span> <span class="o">==&gt;</span> <span class="s2">&quot;hello, </span><span class="si">$name</span><span class="s2"> (</span><span class="si">$id</span><span class="s2">)!&quot;</span><span class="p">);</span></code></pre></div>

<p>You can also include regular expressions with your named parameters by using the : delimiter:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/@name/@id:[0-9]{3}&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$id</span><span class="p">)</span> <span class="o">==&gt;</span> <span class="p">{</span>
    <span class="s1">&#39;This will match /bob/123, But will not match /bob/12345&#39;</span>
<span class="p">});</span></code></pre></div>

<h2 id="optional-parameters">Optional Parameters</h2>
<p>You can specify named parameters that are optional for matching by wrapping segments in parentheses.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/blog(/@year(/@month(/@day)))&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nv">$year</span><span class="p">,</span> <span class="nv">$month</span><span class="p">,</span> <span class="nv">$day</span><span class="p">)</span> <span class="o">==&gt;</span> <span class="p">{</span>
    <span class="c1">// This will match the following URLS:</span>
    <span class="c1">// /blog/2012/12/10</span>
    <span class="c1">// /blog/2012/12</span>
    <span class="c1">// /blog/2012</span>
    <span class="c1">// /blog</span>
<span class="p">});</span></code></pre></div>

<p>Any optional parameters that are not matched will be passed in as NULL.</p>

<h2 id="wildcards">Wildcards</h2>
<p>Matching is only done on individual URL segments. If you want to match multiple segments you can use the * wildcard.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/blog/*&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="p">{</span>
    <span class="c1">// This will match /blog/2000/02/01</span>
<span class="p">});</span></code></pre></div>

<p>To route all requests to a single callback, you can do:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="p">{</span>
    <span class="c1">// Do something</span>
<span class="p">});</span></code></pre></div>

<h1 id="testing">Testing</h1>
<p>Flight is written in such a way that helps you to write test cases for your routes/controllers</p>

<h2 id="code-structure">Code structure</h2>
<p>Letâ€™s say we have these files in our project:</p>

<ul>
  <li>routes.hh</li>
  <li>app.hh</li>
  <li>t/MyApplicationTest.hh</li>
</ul>

<p>route.hh:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span> <span class="c1">//partial</span>
<span class="k">require</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/vendor/autoload.php&#39;</span><span class="p">;</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Fighter\Application</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="s1">&#39;Welcome to default route&#39;</span><span class="p">);</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;/foo&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">==&gt;</span> <span class="s1">&#39;bar&#39;</span><span class="p">);</span>

<span class="k">return</span> <span class="nv">$app</span><span class="p">;</span></code></pre></div>

<p>app.hh:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span> <span class="c1">//partial</span>
<span class="nv">$app</span> <span class="o">=</span> <span class="k">require</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/routes.hh&#39;</span><span class="p">;</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span></code></pre></div>

<p>And then you can write test by extending from Fighter\Test\WebCase</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><span class="nx">hh</span> <span class="c1">//partial</span>
<span class="k">class</span> <span class="nc">MyApplicationTest</span> <span class="k">extends</span> <span class="nx">\Fighter\Test\WebCase</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">app</span> <span class="o">=</span> <span class="k">require</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/../routes.hh&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testDefaultRoute</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$client</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createClient</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">app</span><span class="p">);</span>
        <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span>
            <span class="s1">&#39;Welcome to default route&#39;</span><span class="p">,</span>
            <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">getResponse</span><span class="p">()</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testFooRoute</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$client</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createClient</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">app</span><span class="p">);</span>
        <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/foo&#39;</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span>
            <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
            <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">getResponse</span><span class="p">()</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<h2 id="runing-the-test">Runing the test</h2>
<p>You can run it with PHPUnit</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>./bin/phpunit --debug t/MyApplicationTest.hh
PHPUnit 4.4.1 by Sebastian Bergmann.

Starting <span class="nb">test</span> <span class="s1">&#39;MyApplicationTest::testDefaultRoute&#39;</span>.
.
Starting <span class="nb">test</span> <span class="s1">&#39;MyApplicationTest::testFooRoute&#39;</span>.
.

Time: 1.02 seconds, Memory: 17.26Mb

OK <span class="o">(</span><span class="m">2</span> tests, <span class="m">2</span> assertions<span class="o">)</span></code></pre></div>

<h1 id="extending">Extending</h1>

<script>
$('#main_content').toc();
</script>


        </div>
    </div>
</body>

